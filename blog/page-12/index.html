<!DOCTYPE html>
<html>
  <head>
    <title>Blog | Chris Oliver | St. Louis Ruby on Rails Web Developer</title>

    
    <meta name="author" content="Chris Oliver">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="google-site-verification" content="k8E8tt4Xn45P84zs5M6Z-4cMIGwdbGMJSDSkL6VzvMk" />

    <link rel="alternate" type="application/rss+xml" title="Chris Oliver / excid3.com Feed" href="http://excid3.com/feed.xml"/>

    <!--<link rel="shortcut icon" href="favicon.png">-->
    <link href='/assets/global-c224c07eca6e857790f0324871c8800e.css' rel='stylesheet' type='text/css' />


    <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet" />

    <script type="text/javascript" data-cfasync="false">
      (function() {
        var config = {
          kitId: 'voa6eso',
          scriptTimeout: 3000
        };
        var h=document.getElementsByTagName("html")[0];h.className+=" wf-loading";var t=setTimeout(function(){h.className=h.className.replace(/(\s|^)wf-loading(\s|$)/g," ");h.className+=" wf-inactive"},config.scriptTimeout);var tk=document.createElement("script"),d=false;tk.src='//use.typekit.net/'+config.kitId+'.js';tk.type="text/javascript";tk.async="true";tk.onload=tk.onreadystatechange=function(){var a=this.readyState;if(d||a&&a!="complete"&&a!="loaded")return;d=true;clearTimeout(t);try{Typekit.load(config)}catch(b){}};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(tk,s)
      })();
    </script>

    <link href="https://plus.google.com/106699287110566383664/" rel="author" />
  </head>
  <body>
    <div class="fluid-container header">
  <div class="container">
    <nav class="pull-right">
      <!--<a href="http://gorails.com" class="btn btn-gorails btn-gorails-green">Learn Ruby On Rails</a>-->
      <!--<a href="/prototype">Prototype</a>
      <a href="/improve">Improve</a>
      <a>|</a>-->
      <a href="http://gorails.com">Learn Ruby on Rails</a>
      <a>|</a>
      <a href="/blog">Blog</a>
      <a href="/contact" class="btn btn-gorails btn-gorails-red">Hire Me</a>
    </nav>
    <h1 class="name"><a href="/">Chris Oliver</a></h1>
  </div>
</div>


    <section id="blog">
  <div class="container">
    <div class="row">
      <div class="span8 offset2">

        <p class="archive">Looking for old posts? Visit the <a href="/blog/archive">archive</a>.</p>

        
          <article class="first">
            <div class="article-head">
              <h2 class="title"><a href="/blog/upgrade-postgres-9-1-to-9-2" class="js-pjax">Upgrade Postgres 9.1 to 9.2</a></h2>
              <p class="date">Oct 11, 2012</p>
            </div><!--/.article-head-->
            <div class="article-content">
              <p>This is a really quick guide to upgrade postgres 9.1 to 9.2. I recently used homebrew to upgrade them, and I realized I could no longer start the postgres server. For me, I was able to find the error causing it in <code>/usr/local/var/postgres/server.log</code>:</p>

<blockquote><p>FATAL: database files are incompatible with server
DETAIL: The data directory was initialized by PostgreSQL version 9.1.4, which is not compatible with this version 9.2.1.</p></blockquote>

<h2>The Solution</h2>

<p>First things first, if you have any production data, make sure you <strong>make a full backup</strong> before following any of the steps below.</p>

<p>It’s relatively painless to upgrade Postgres 9.1 to 9.2, although I would have hoped that homebrew would have notified me of this problem and helped me through the upgrade.</p>

<pre><code>cd /usr/local/var
mkdir postgres9.2

# Initialize a the new postgres 9.2 database
initdb /usr/local/var/postgres9.2

# Tell postgres we are upgrading the existing postgres database to the new postgres9.2 location
pg_upgrade -d /usr/local/var/postgres/ -D /usr/local/var/postgres9.2 -b /usr/local/Cellar/postgresql/9.1.4/bin/ -B /usr/local/Cellar/postgresql/9.2.1/bin/ -v

# Swap the folders
mv postgres postgres9.1.4
mv postgres9.2 postgres

# Remove this unnecessary helper file
rm delete_old_cluster.sh

# Restart postgres
launchctl unload -w homebrew.mxcl.postgresql.plist
launchctl load -w homebrew.mxcl.postgresql.plist
</code></pre>

<p>And you’re done. It’s really simple to upgrade postgres 9.1 to 9.2. If you’re on different versions, just swap out the numbers and you should be fine. There is some <a href="www.postgresql.org/docs/current/static/pgupgrade.html" title="pg_upgrade">useful documentation</a> for the <code>pg_upgrade</code> command that I would recommend checking out as well. Better safe than sorry, especially if you are upgrading a database in production.</p>

            </div><!--/.article-content-->
          </article>
          <div class="separater"></div>
        
          <article class="middle">
            <div class="article-head">
              <h2 class="title"><a href="/blog/setting-up-rails-on-ubuntu-12-10-quantal-quetzal-with-ruby-node-js-nginx-passenger-and-mysql-or-postgres" class="js-pjax">Setting Up Rails On Ubuntu 12.10 Quantal Quetzal with Ruby, Node.JS, Nginx, Passenger, and MySQL or Postgres
</a></h2>
              <p class="date">Sep 28, 2012</p>
            </div><!--/.article-head-->
            <div class="article-content">
              <p>Keeping up with the latest Ubuntu version is always quite the task. As usual, here’s my quick guide to setting up Rails on Ubuntu 12.10 Quantal Quetzal for hosting a production or development Rails application. This also works well for development, but you will most likely not need Nginx and [Passenger][1] if that’s the case. For development, you can use the bundled Webrick server for convenience. Note that you can set this up on either Ubuntu desktop or server versions and the instructions will be primarily the same.</p>

<h2>Install Ubuntu</h2>

<p>I’ll leave this up to you. For me, I’m using Ubuntu Server 12.10 and the only extra option I chose was to install the OpenSSH server by default. If you’re using a VPS, you’re already going to have ssh server installed by default.</p>

<h2>Add The Deploy User</h2>

<p>The deploy user is the user whom our application run as for security reasons.</p>

<pre><code>sudo adduser deploy
</code></pre>

<p>Fill out the password and you can skip the name and other details of this user as they aren’t important.</p>

<p>You can stay as your regular user or root for the following steps. It’s best that you don’t give your deploy user root access in case your application got compromised.</p>

<h2>Installing Our Dependencies</h2>

<p>The following two commands are going to upgrade any existing packages we have as well as install the dependencies we are going to need to build Ruby properly.</p>

<pre><code>sudo apt-get -y update &amp;&amp; sudo apt-get -y upgrade
sudo apt-get -y install build-essential zlib1g-dev libssl-dev libreadline-dev libyaml-dev libcurl4-openssl-dev curl git-core python-software-properties
</code></pre>

<h2>Installing Ruby 1.9.3</h2>

<p>Now you’ll want to grab the latest version of Ruby from [ruby-lang.org][2] and not necessarily use the one I’ve got listed here.</p>

<p>The following commands will download the Ruby source, extract it, configure and compile it, and then finally install Bundler.</p>

<pre><code>wget ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.3-p286.tar.gz
tar -xvzf ruby-1.9.3-p286.tar.gz
cd ruby-1.9.3-p286/
./configure
make
sudo make install
sudo gem install bundler
</code></pre>

<h2>Installing NodeJS</h2>

<p>Another dependency we need to install is a Javascript runtime. A runtime is required for asset compilation with the Rails asset pipeline. We’re going to use node for this.</p>

<pre><code>sudo apt-add-repository ppa:chris-lea/node.js
sudo apt-get -y update
sudo apt-get -y install nodejs
</code></pre>

<h2>Installing Your Database</h2>

<p>This is up to you of course, however I’d recommend using PostgreSQL if you’re unsure.</p>

<p><strong>Installing Postgres 9.2</strong></p>

<pre><code>sudo apt-add-repository ppa:pitti/postgresql
sudo apt-get -y update
sudo apt-get -y install postgresql-9.2 libpq-dev
</code></pre>

<h5>OR</h5>

<p><strong>Installing MySQL 5.5.27</strong></p>

<pre><code>sudo apt-get install mysql-server mysql-client libmysqlclient-dev
</code></pre>

<h2>Installing Nginx and Passenger</h2>

<p>To install Nginx, we’re going to use Passenger’s install script to do that for us. Nginx modules must be compiled with it, unlike Apache.</p>

<pre><code>gem install passenger
passenger-install-nginx-module
</code></pre>

<p>Just choose the first option (1) to download and install it for you. Accept any defaults it suggests, like installation directories. If you need custom options while compiling nginx, just follow choice #2.</p>

<p>After installation is finished, you’ll get some configuration tips for Nginx to use Passenger, and we’re going to make one other change. Open up <code>/opt/nginx/conf/nginx.conf</code> and add the following line at the top:</p>

<pre><code>user deploy staff;
</code></pre>

<p>This will configure your nginx workers to run as the deploy user instead of root.</p>

<p>Since we are compiling nginx from source, we don’t get the nifty start/stop script from Ubuntu’s package. The reason we did compiled from source was so that we can always get the latest version of Passenger and Nginx (or if you needed anything custom installed).</p>

<p>Let’s grab an init script from Linode’s website and install it.</p>

<pre><code>wget -O init-deb.sh http://library.linode.com/assets/660-init-deb.sh
sudo mv init-deb.sh /etc/init.d/nginx
sudo chmod  x /etc/init.d/nginx
sudo /usr/sbin/update-rc.d -f nginx defaults
</code></pre>

<p>Once that’s done, you can start and stop nginx like so:</p>

<pre><code>sudo /etc/init.d/nginx stop
sudo /etc/init.d/nginx start
</code></pre>

<h2>Wrapping Up Rails On Ubuntu 12.10</h2>

<p>And that’s mostly it. If you’re using this for development, you can just <code>gem install rails</code> and get started.</p>

<p>For production, I’ll leave capistrano configurations up to you. You’ll be able to use the <code>deploy</code> user’s home directory to store the production application(s) and you can easily configure nginx like so:</p>

<pre><code>server {
    listen 80;
    server_name example.com;
    root /home/deploy/MYAPPLICATION/public;   # 
</code></pre>

            </div><!--/.article-content-->
          </article>
          <div class="separater"></div>
        
          <article class="last">
            <div class="article-head">
              <h2 class="title"><a href="/blog/stop-overengineering" class="js-pjax">Stop Overengineering</a></h2>
              <p class="date">Sep 27, 2012</p>
            </div><!--/.article-head-->
            <div class="article-content">
              <p>Something I constantly find are overly complicated applications. Whatever it is that you’re building right now… stop. Take a second to analyze your situation.</p>

<p>As humans, we like to be optimistic about our ideas. We are going to make a billion dollars. This is going to have a million users. We need to be able to scale to 10,000 requests per second.</p>

<p><strong>Stop it.</strong></p>

<p>Let’s start with something I read yesterday on Twitter:</p>

<blockquote><p>Campfire, to this day, still uses a 3-second poll. And chat was supposed to be the poster-boy example for web sockets and friends. Ha.</p>

<p>— DHH (@dhh) <a href="https://twitter.com/dhh/status/251006155906752513">September 26, 2012</a></p></blockquote>

<p>One of the most popular chat applications for businesses is not truly realtime. And do you know what? <strong>Nobody even cares.</strong> Nobody even notices, and that should amaze you.</p>

<p>This is such an important thing to note when you’re building a business or product.</p>

<p><strong>Users don’t care how your product works. They just want it to do its job.</strong></p>

<p>If you’re building something new, first you need to get people using it. You don’t need to plan for scale until you’re actually approaching scale.</p>

<p>Especially in the startup space, you’re going to be continuously changing your software. Think about what gets the job done properly right now and do that. <strong>No product is ever fully designed at the beginning. Build software that’s ready for change.</strong></p>

            </div><!--/.article-content-->
          </article>
          
        

        <div class="blog-navigation">

          <!--<span class="page_number ">Page: 12 of 79</span>-->

          <div class="pull-left">
            
              <a href="/blog/page-13" class="btn btn-gorails btn-gorails-red next">← Older Posts</a>
            
          </div>

          <div class="pull-right">
            
              
                <a href="/blog/page-11" class="btn btn-gorails btn-gorails-red previous">Newer Posts →</a>
              
            
          </div>
        </div>

      </div>
    </div>
  </div>
</section>


    <!--
<div id="footer-nav">
  <ul>
    <li><a class="home" href="http://excid3.com/blog">home</a></li>
    <li><a class="rss" href="http://feeds.feedburner.com/excid3">rss feed</a></li>
    <li><a class="archives" href="http://excid3.com/blog/archives/">archives</a></li>
    <li><a class="email" href="mailto:chris@excid3.com?subject=hello!">say hello</a></li>
    <li><a class="twitter" href="http://twitter.com/excid3">twitter</a></li>
    <li><a class="github" href="http://github.com/excid3">github</a></li>
  </ul>
</div>
-->


<footer class="clearfix">
  <div class="container">
    <p class="pull-left">Do things that scare you.</p>
    <p class="pull-right">Learn about <a href="http://gorails.com/st-louis-ruby-on-rails">St. Louis Ruby on Rails</a></p>
  </div>
</footer>


    <!-- Google Analytics -->
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8399719-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>
  </body>
</html>
