<!DOCTYPE html>
<html>
  <head>
    <title>Setting Up Rails On Ubuntu 12.10 Quantal Quetzal with Ruby, Node.JS, Nginx, Passenger, and MySQL or Postgres
</title>
    <meta name="author" content="Chris Oliver">
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8" >
    <meta name="google-site-verification" content="k8E8tt4Xn45P84zs5M6Z-4cMIGwdbGMJSDSkL6VzvMk" />

    <!--<link rel="shortcut icon" href="favicon.png">-->
    <link href='/assets/global-09e65ed72b4f08933d57dbbe6ee22514.css' rel='stylesheet' type='text/css' />


    <link href="//netdna.bootstrapcdn.com/font-awesome/3.2.1/css/font-awesome.css" rel="stylesheet" />

    <script type="text/javascript" src="/js/prism.js"></script>

    <script type="text/javascript" data-cfasync="false">
      (function() {
        var config = {
          kitId: 'voa6eso',
          scriptTimeout: 3000
        };
        var h=document.getElementsByTagName("html")[0];h.className+=" wf-loading";var t=setTimeout(function(){h.className=h.className.replace(/(\s|^)wf-loading(\s|$)/g," ");h.className+=" wf-inactive"},config.scriptTimeout);var tk=document.createElement("script"),d=false;tk.src='//use.typekit.net/'+config.kitId+'.js';tk.type="text/javascript";tk.async="true";tk.onload=tk.onreadystatechange=function(){var a=this.readyState;if(d||a&&a!="complete"&&a!="loaded")return;d=true;clearTimeout(t);try{Typekit.load(config)}catch(b){}};var s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(tk,s)
      })();
    </script>

    <link href="https://plus.google.com/106699287110566383664/" rel="author" />
  </head>
  <body>
    <div class="fluid-container header">
  <div class="container">
    <nav class="pull-right">
      <!--<a href="http://gorails.com" class="btn btn-gorails btn-gorails-green">Learn Ruby On Rails</a>-->
      <!--<a href="/prototype">Prototype</a>
      <a href="/improve">Improve</a>
      <a>|</a>-->
      <a href="http://gorails.com">Learn Ruby on Rails</a>
      <a>|</a>
      <a href="/blog">Blog</a>
      <a href="/contact" class="btn btn-gorails btn-gorails-red">Hire Me</a>
    </nav>
    <h1 class="name"><a href="/">Chris Oliver</a></h1>
  </div>
</div>


    <section id="blog">
      <div class="container">
        <div class="row">
          <div class="span8 offset2">
            <div class="article-head">
              <h2 class="title"><a href="/blog/setting-up-rails-on-ubuntu-12-10-quantal-quetzal-with-ruby-node-js-nginx-passenger-and-mysql-or-postgres" class="js-pjax">Setting Up Rails On Ubuntu 12.10 Quantal Quetzal with Ruby, Node.JS, Nginx, Passenger, and MySQL or Postgres
</a></h2>
              <p class="date">Sep 28, 2012</p>
            </div><!--/.article-head-->

            <div class="article-content">
              <p>Keeping up with the latest Ubuntu version is always quite the task. As usual, here’s my quick guide to setting up Rails on Ubuntu 12.10 Quantal Quetzal for hosting a production or development Rails application. This also works well for development, but you will most likely not need Nginx and [Passenger][1] if that’s the case. For development, you can use the bundled Webrick server for convenience. Note that you can set this up on either Ubuntu desktop or server versions and the instructions will be primarily the same.</p>

<h2>Install Ubuntu</h2>

<p>I’ll leave this up to you. For me, I’m using Ubuntu Server 12.10 and the only extra option I chose was to install the OpenSSH server by default. If you’re using a VPS, you’re already going to have ssh server installed by default.</p>

<h2>Add The Deploy User</h2>

<p>The deploy user is the user whom our application run as for security reasons.</p>

<pre><code>sudo adduser deploy
</code></pre>

<p>Fill out the password and you can skip the name and other details of this user as they aren’t important.</p>

<p>You can stay as your regular user or root for the following steps. It’s best that you don’t give your deploy user root access in case your application got compromised.</p>

<h2>Installing Our Dependencies</h2>

<p>The following two commands are going to upgrade any existing packages we have as well as install the dependencies we are going to need to build Ruby properly.</p>

<pre><code>sudo apt-get -y update &amp;&amp; sudo apt-get -y upgrade
sudo apt-get -y install build-essential zlib1g-dev libssl-dev libreadline-dev libyaml-dev libcurl4-openssl-dev curl git-core python-software-properties
</code></pre>

<h2>Installing Ruby 1.9.3</h2>

<p>Now you’ll want to grab the latest version of Ruby from [ruby-lang.org][2] and not necessarily use the one I’ve got listed here.</p>

<p>The following commands will download the Ruby source, extract it, configure and compile it, and then finally install Bundler.</p>

<pre><code>wget ftp://ftp.ruby-lang.org/pub/ruby/1.9/ruby-1.9.3-p286.tar.gz
tar -xvzf ruby-1.9.3-p286.tar.gz
cd ruby-1.9.3-p286/
./configure
make
sudo make install
sudo gem install bundler
</code></pre>

<h2>Installing NodeJS</h2>

<p>Another dependency we need to install is a Javascript runtime. A runtime is required for asset compilation with the Rails asset pipeline. We’re going to use node for this.</p>

<pre><code>sudo apt-add-repository ppa:chris-lea/node.js
sudo apt-get -y update
sudo apt-get -y install nodejs
</code></pre>

<h2>Installing Your Database</h2>

<p>This is up to you of course, however I’d recommend using PostgreSQL if you’re unsure.</p>

<p><strong>Installing Postgres 9.2</strong></p>

<pre><code>sudo apt-add-repository ppa:pitti/postgresql
sudo apt-get -y update
sudo apt-get -y install postgresql-9.2 libpq-dev
</code></pre>

<h5>OR</h5>

<p><strong>Installing MySQL 5.5.27</strong></p>

<pre><code>sudo apt-get install mysql-server mysql-client libmysqlclient-dev
</code></pre>

<h2>Installing Nginx and Passenger</h2>

<p>To install Nginx, we’re going to use Passenger’s install script to do that for us. Nginx modules must be compiled with it, unlike Apache.</p>

<pre><code>gem install passenger
passenger-install-nginx-module
</code></pre>

<p>Just choose the first option (1) to download and install it for you. Accept any defaults it suggests, like installation directories. If you need custom options while compiling nginx, just follow choice #2.</p>

<p>After installation is finished, you’ll get some configuration tips for Nginx to use Passenger, and we’re going to make one other change. Open up <code>/opt/nginx/conf/nginx.conf</code> and add the following line at the top:</p>

<pre><code>user deploy staff;
</code></pre>

<p>This will configure your nginx workers to run as the deploy user instead of root.</p>

<p>Since we are compiling nginx from source, we don’t get the nifty start/stop script from Ubuntu’s package. The reason we did compiled from source was so that we can always get the latest version of Passenger and Nginx (or if you needed anything custom installed).</p>

<p>Let’s grab an init script from Linode’s website and install it.</p>

<pre><code>wget -O init-deb.sh http://library.linode.com/assets/660-init-deb.sh
sudo mv init-deb.sh /etc/init.d/nginx
sudo chmod  x /etc/init.d/nginx
sudo /usr/sbin/update-rc.d -f nginx defaults
</code></pre>

<p>Once that’s done, you can start and stop nginx like so:</p>

<pre><code>sudo /etc/init.d/nginx stop
sudo /etc/init.d/nginx start
</code></pre>

<h2>Wrapping Up Rails On Ubuntu 12.10</h2>

<p>And that’s mostly it. If you’re using this for development, you can just <code>gem install rails</code> and get started.</p>

<p>For production, I’ll leave capistrano configurations up to you. You’ll be able to use the <code>deploy</code> user’s home directory to store the production application(s) and you can easily configure nginx like so:</p>

<pre><code>server {
    listen 80;
    server_name example.com;
    root /home/deploy/MYAPPLICATION/public;   # 
</code></pre>


              <p><strong>P.S.</strong> <a href="https://twitter.com/excid3/">You might enjoy following me on Twitter.</a></p>
            </div><!--/.article-content-->

            <nav class="share">
              <a href="https://twitter.com/share" class="twitter-share-button" data-via="excid3" data-related="excid3">Tweet</a>
              <div class="g-plusone" data-size="medium"></div>
              <script src="//platform.linkedin.com/in.js" type="text/javascript">lang: en_US</script><script type="IN/Share" data-counter="right"></script>
            </nav>

            <div class="blog-navigation">
              <div class="pull-left">
                
                <a href="/blog/stop-overengineering" title="Stop Overengineering" class="btn btn-gorails btn-gorails-red">&laquo; Stop Overengineering</a>
                
              </div>

              <div class="pull-right">
                
                <a href="/blog/upgrade-postgres-9-1-to-9-2" title="Upgrade Postgres 9.1 to 9.2" class="btn btn-gorails btn-gorails-red">Upgrade Postgres 9.1 to 9.2 &raquo; </a>
                
              </div>
            </div>

            <div id="disqus_thread"></div>
            <noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
            <a href="http://disqus.com" class="dsq-brlink">comments powered by <span class="logo-disqus">Disqus</span></a>

            <div class="light-well about">
              <a href="http://excid3.com">
                <div class="pull-left">
                  <img src="http://www.gravatar.com/avatar/ce795239ba5dd2384fc2f88ffaff5451.png" alt="Chris Oliver" />
                </div>
                <p>Chris Oliver specializes in web development and user experience design with Ruby on Rails, Javascript, HTML5, and CSS3 in St. Louis, MO</p>
              </a>
            </div>

          </div>
        </div>
      </div>
    </section>

    <!--
<div id="footer-nav">
  <ul>
    <li><a class="home" href="http://excid3.com/blog">home</a></li>
    <li><a class="rss" href="http://feeds.feedburner.com/excid3">rss feed</a></li>
    <li><a class="archives" href="http://excid3.com/blog/archives/">archives</a></li>
    <li><a class="email" href="mailto:chris@excid3.com?subject=hello!">say hello</a></li>
    <li><a class="twitter" href="http://twitter.com/excid3">twitter</a></li>
    <li><a class="github" href="http://github.com/excid3">github</a></li>
  </ul>
</div>
-->


<footer class="clearfix">
  <div class="container">
    <p class="pull-left">Do things that scare you.</p>
    <p class="pull-right">Learn about <a href="http://gorails.com/st-louis-ruby-on-rails">St. Louis Ruby on Rails</a></p>
  </div>
</footer>


    <!-- SubHub.io -->
    <script>
      (function(s,u,b,hh,uu,bb){
        uu=document.createElement(u);
        uu.setAttribute('data-subhub',hh);
        uu.setAttribute('data-panel',true);
        uu.async=1;uu.src=b;
        bb=s.getElementsByTagName(u)[0];
        bb.parentNode.insertBefore(uu,bb);
      })(document, 'script',
        'https://assets.subhub.io/v1/subhub.js',
        'a48820f5-a170-4e4c-97cf-ced8d190679e');
    </script>

    <!-- Google Analytics -->
    <script type="text/javascript">
    var _gaq = _gaq || [];
    _gaq.push(['_setAccount', 'UA-8399719-1']);
    _gaq.push(['_trackPageview']);

    (function() {
      var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
      ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
      var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
    })();
    </script>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'excid3'; // required: replace example with your forum shortname

        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function() {
            var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
            dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
            (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
        })();
    </script>

    <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+'://platform.twitter.com/widgets.js';fjs.parentNode.insertBefore(js,fjs);}}(document, 'script', 'twitter-wjs');</script>

    <script type="text/javascript">
      (function() {
        var po = document.createElement('script'); po.type = 'text/javascript'; po.async = true;
        po.src = 'https://apis.google.com/js/plusone.js';
        var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(po, s);
      })();
    </script>
  </body>
</html>

